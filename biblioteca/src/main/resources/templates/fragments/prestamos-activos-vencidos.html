<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<body>
<div th:fragment="tabla-activos">
    <table th:if="${!#lists.isEmpty(prestamosActivos)}">
        <thead>
        <tr>
            <th th:text="#{prestamos.id}">ID</th>
            <th th:text="#{prestamos.libro}">Libro</th>
            <th th:text="#{prestamos.usuario}">Usuario</th>
            <th th:text="#{prestamos.fecha.prestamo}">Fecha Préstamo</th>
            <th th:text="#{prestamos.fecha.devolucion}">Fecha Devolución</th>
            <th th:text="#{prestamos.estado}">Estado</th>
            <th sec:authorize="hasRole('ADMIN')" th:text="#{prestamos.acciones}">Acciones</th>
        </tr>
        </thead>
        <tbody>
        <tr th:each="prestamo : ${prestamosActivos}" th:class="${prestamo.estado.name() == 'VENCIDO'} ? 'vencido' : ''">
            <td th:text="${prestamo.id}"></td>
            <td th:text="${prestamo.libro.titulo}"></td>
            <td th:text="${prestamo.usuario.nombre}"></td>
            <td th:text="${prestamo.fechaPrestamo}"></td>
            <td th:text="${prestamo.fechaDevolucion}"></td>
            <td th:text="${prestamo.estado}"></td>
            <td sec:authorize="hasRole('ADMIN')">
                <a th:href="@{/prestamos/devolver/{id}(id=${prestamo.id})}" th:text="#{prestamos.btn.devolver}">Devolver</a>
                <a th:href="@{/prestamos/eliminar/{id}(id=${prestamo.id})}" th:text="#{prestamos.btn.eliminar}" onclick="return confirm('¿Eliminar?')">Eliminar</a>
            </td>
        </tr>
        </tbody>
    </table>
    <p th:if="${#lists.isEmpty(prestamosActivos)}" th:text="#{prestamos.sin.activos}">No hay préstamos activos o vencidos.</p>
</div>
</body>
</html>