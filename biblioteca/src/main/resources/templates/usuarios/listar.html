<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.w3.org/1999/xhtml" lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title th:text="#{usuarios.titulo}">Usuarios</title>
    <link rel="stylesheet" href="/css/styles.css">
</head>
<body>
<nav th:replace="~{fragments/nav :: nav}"></nav>
<main>
    <h1 th:text="${esAdmin} ? #{usuarios.titulo} : #{usuarios.mi.perfil}">Listado de Usuarios</h1>

    <div th:if="${mensaje}" class="mensaje-exito" th:text="#{__${mensaje}__}"></div>
    <div th:if="${error}" class="mensaje-error" th:text="#{__${error}__}"></div>

    <a th:if="${esAdmin}" th:href="@{/registro}" th:text="#{usuarios.nuevo}">Nuevo Usuario</a>

    <table>
        <thead>
        <tr>
            <th th:text="#{usuarios.id}">ID</th>
            <th th:text="#{usuarios.nombre}">Nombre</th>
            <th th:text="#{usuarios.email}">Email</th>
            <th th:text="#{usuarios.rol}">Rol</th>
            <th th:text="#{usuarios.acciones}">Acciones</th>
        </tr>
        </thead>
        <tbody>
        <tr th:each="usuario : ${usuarios}">
            <td th:text="${usuario.id}"></td>
            <td th:text="${usuario.nombre}"></td>
            <td th:text="${usuario.email}"></td>
            <td th:text="${usuario.rol}"></td>
            <td>
                <a th:href="@{/usuarios/editar/{id}(id=${usuario.id})}" th:text="#{usuarios.btn.editar}">Editar</a>
                <a th:if="${puedeEliminarse[usuario.id]}" th:href="@{/usuarios/eliminar/{id}(id=${usuario.id})}" th:text="#{usuarios.btn.eliminar}" onclick="return confirm('Â¿Eliminar?')">Eliminar</a>
                <span th:unless="${puedeEliminarse[usuario.id]}" class="btn-deshabilitado" th:text="#{usuarios.btn.eliminar}">Eliminar</span>
            </td>
        </tr>
        </tbody>
    </table>
</main>
<footer th:replace="~{fragments/footer :: footer}"></footer>
</body>
</html>